{%- liquid
  assign show_on_desktop = section.settings.show_on_desktop
  assign show_on_mobile = section.settings.show_on_mobile
  assign section_height = section.settings.section_height
  assign section_height_mobile = section.settings.section_height_mobile
  assign show_overlay = section.settings.show_overlay
  assign image = section.settings.image
  assign image_mobile = section.settings.image_mobile
  assign image_alignment = section.settings.image_alignment
  assign image_alignment_mobile = section.settings.image_alignment_mobile
  assign image_link = section.settings.image_link
  assign text_position = section.settings.text_position
  assign text_position_mobile = section.settings.text_position_mobile
  assign text_alignment = section.settings.text_alignment
  assign text_alignment_mobile = section.settings.text_alignment_mobile
  assign images_loading_type = section.settings.images_loading_type
  assign color_scheme = section.settings.color_scheme

  capture visibility_class
    render 'section-visibility-class', show_on_mobile: show_on_mobile, show_on_desktop: show_on_desktop
  endcapture
-%}

{%- liquid
  assign image_ratio_on_desktop = 0
  assign image_ratio_on_mobile = 0

  if section_height == 'natural' or section_height_mobile == 'natural'
    if section_height == 'natural'
      assign image_ratio_on_desktop = 56.25
    endif

    if section_height_mobile == 'natural'
      assign image_ratio_on_mobile = 150
    endif

    if image != blank
      if section_height == 'natural'
        assign image_ratio_on_desktop = 100.0 | divided_by: image.aspect_ratio
      endif
    endif

    if image_on_mobile != blank
      if section_height_mobile == 'natural'
        assign image_ratio_on_mobile = 100.0 | divided_by: image_mobile.aspect_ratio
      endif
    endif
  endif
-%}

<style>
  {% if section_height_mobile == 'natural' %}
    [data-section-id='{{ section.id }}'] .image-banner__container {
      height: 0 !important;
      padding-bottom: {{ image_ratio_on_mobile }}%;
    }
  {% endif %}

  @media screen and (min-width: 768px) {
    [data-section-id='{{ section.id }}'] .image-banner__container {
      {% if section_height == 'natural' %}
        height: 0 !important;
        padding-bottom: {{ image_ratio_on_desktop }}%;
      {% else %}
        padding-bottom: 0;
      {% endif %}
    }
  }
</style>

{%- if settings.dbtfy_image_banner -%}
  <div class="image-banner image-banner--{{ section_height }} image-banner--{{ section_height_mobile }}-mobile section section--no-top-spacing section--no-bottom-spacing {{ visibility_class }} color-{{ color_scheme }}" data-section-id="{{ section.id }}">
    <div class="image-banner__container media-wrapper media-wrapper--cover media-wrapper--{{ image_alignment_mobile }} media-wrapper--desktop-{{ image_alignment }}{% if show_overlay %} overlay{% endif %}">
      {%- if image != blank or image_mobile != blank -%}
        {%- if image != blank -%}
          {%- capture sizes -%}100vw{% endcapture %}

          {%- liquid
            if slides_count > 1
              echo image | image_url: width: image.width | image_tag: loading: images_loading_type, sizes: sizes, widths: '300,400,500,600,700,800,1000,1200,1400,1600,1800,2000,2200,2400,2600', class: 'media media--desktop d-none d-md-block' | replace: 'src=', 'data-src=' | replace: 'srcset=', 'data-srcset='
            else
              echo image | image_url: width: image.width | image_tag: loading: images_loading_type, sizes: sizes, widths: '300,400,500,600,700,800,1000,1200,1400,1600,1800,2000,2200,2400,2600', class: 'media media--desktop d-none d-md-block'
            endif
          -%}
        {%- else -%}
          {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg media media--desktop d-none d-md-block' }}
        {%- endif -%}

        {%- if image_mobile != blank -%}
          {%- capture sizes -%}100vw{% endcapture %}

          {%- liquid
            if slides_count > 1
              echo image_mobile | image_url: width: image_mobile.width | image_tag: loading: images_loading_type, sizes: sizes, widths: '300,400,500,600,700,800,1000,1200,1400,1600,1800,2000,2200,2400,2600', class: 'media media--mobile d-md-none' | replace: 'src=', 'data-src=' | replace: 'srcset=', 'data-srcset='
            else
              echo image_mobile | image_url: width: image_mobile.width | image_tag: loading: images_loading_type, sizes: sizes, widths: '300,400,500,600,700,800,1000,1200,1400,1600,1800,2000,2200,2400,2600', class: 'media media--mobile d-md-none'
            endif
          -%}
        {%- else -%}
          {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg media media--mobile d-md-none' }}
        {%- endif -%}
      {%- else -%}
        {{ 'lifestyle-1' | placeholder_svg_tag: 'media placeholder-svg' }}
      {%- endif -%}

      <div class="media-wrapper__content {{ text_position }} {{ text_position_mobile }}">
        <div class="container d-flex {{ text_alignment }} {{ text_alignment_mobile }}">
          <div class="image-banner__content row gy-3">
            {%- for block in section.blocks -%}
              {%- case block.type -%}
                {%- when 'heading' -%}
                  {%- liquid
                    assign heading = block.settings.heading
                  -%}

                  {%- if heading != blank -%}
                    <div>
                      <h1 class="page-title h1">
                        {{ heading | escape }}
                      </h1>
                    </div>
                  {%- endif -%}

                {%- when 'text' -%}
                  {%- liquid
                    assign text = block.settings.text
                    assign text_size = block.settings.text_size
                  -%}

                  {%- if text != blank -%}
                    <div class="rte{% if text_size == 'large' %} sm:text-lg{% endif %}">{{ text }}</div>
                  {%- endif -%}

                {%- when 'buttons' -%}
                  {%- liquid
                    assign button_label_1 = block.settings.button_label_1
                    assign button_link_1 = block.settings.button_link_1
                    assign button_style_1 = block.settings.button_style_1

                    assign button_label_2 = block.settings.button_label_2
                    assign button_link_2 = block.settings.button_link_2
                    assign button_style_2 = block.settings.button_style_2
                  -%}

                  {%- unless image_link -%}
                    {%- if button_label_1 != blank or button_label_2 != blank -%}
                      <div>
                        <div class="row row-cols-auto {{ text_alignment }} {{ text_alignment_mobile }} gx-2 gy-2">
                          {%- if button_label_1 != blank -%}
                            <div>
                              <a href="{{ button_link_1 }}" class="btn {{ button_style_1 }}">
                                <span class="visually-hidden">Click to open {{ button_link_1 }} link</span>
                                {{ button_label_1 | escape }}
                              </a>
                            </div>
                          {%- endif -%}

                          {%- if button_label_2 != blank -%}
                            <div>
                              <a href="{{ button_link_2 }}" class="btn {{ button_style_2 }}">
                                <span class="visually-hidden">Click to open {{ button_link_1 }} link</span>
                                {{ button_label_2 | escape }}
                              </a>
                            </div>
                          {%- endif -%}
                        </div>
                      </div>
                    {%- endif -%}
                  {%- endunless -%}

              {%- endcase -%}
            {%- endfor -%}
          </div>
        </div>
      </div>

      {%- if image_link != blank -%}
        <a class="image-banner__image-link" href="{{ image_link }}"></a>
      {%- endif -%}
    </div>
  </div>
{%- endif -%}

{% schema %}
{
  "name": "t:sections.image_banner.name",
  "disabled_on": {
    "groups": [
      "custom.widgets",
      "custom.general",
      "header"
    ]
  },
  "settings": [
    {
      "type": "header",
      "content": "t:general.addons.help_center.header.content"
    },
    {
      "type": "paragraph",
      "content": "t:general.addons.help_center.image_banner.content"
    },
    {
      "type": "paragraph",
      "content": "t:general.addons.help_center.enable_disable.content"
    },
    {
      "type": "header",
      "content": "t:general.addons.settings.header.content"
    },
    {
      "type": "checkbox",
      "id": "show_on_desktop",
      "label": "t:general.settings.show_on_desktop.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_on_mobile",
      "label": "t:general.settings.show_on_mobile.label",
      "default": true
    },
    {
      "type": "select",
      "id": "section_height",
      "label": "t:sections.image_banner.settings.section_height.label",
      "default": "natural",
      "options": [
        {
          "value": "natural",
          "label": "t:sections.image_banner.settings.section_height.options__1.label"
        },
        {
          "value": "xs",
          "label": "t:sections.image_banner.settings.section_height.options__2.label"
        },
        {
          "value": "sm",
          "label": "t:sections.image_banner.settings.section_height.options__3.label"
        },
        {
          "value": "md",
          "label": "t:sections.image_banner.settings.section_height.options__4.label"
        },
        {
          "value": "lg",
          "label": "t:sections.image_banner.settings.section_height.options__5.label"
        },
        {
          "value": "full-screen",
          "label": "t:sections.image_banner.settings.section_height.options__6.label"
        }
      ]
    },
    {
      "type": "select",
      "id": "section_height_mobile",
      "label": "t:sections.image_banner.settings.section_height_mobile.label",
      "default": "natural",
      "options": [
        {
          "value": "natural",
          "label": "t:sections.image_banner.settings.section_height_mobile.options__1.label"
        },
        {
          "value": "xs",
          "label": "t:sections.image_banner.settings.section_height_mobile.options__2.label"
        },
        {
          "value": "sm",
          "label": "t:sections.image_banner.settings.section_height_mobile.options__3.label"
        },
        {
          "value": "md",
          "label": "t:sections.image_banner.settings.section_height_mobile.options__4.label"
        },
        {
          "value": "lg",
          "label": "t:sections.image_banner.settings.section_height_mobile.options__5.label"
        },
        {
          "value": "full-screen",
          "label": "t:sections.image_banner.settings.section_height_mobile.options__6.label"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.image_banner.settings.header__1.content"
    },
    {
      "type": "checkbox",
      "id": "show_overlay",
      "label": "t:sections.image_banner.settings.show_overlay.label",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:sections.image_banner.settings.image.label"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "t:sections.image_banner.settings.image_mobile.label",
      "info": "t:sections.image_banner.settings.image_mobile.info"
    },
    {
      "type": "select",
      "id": "image_alignment",
      "label": "t:sections.image_banner.settings.image_alignment.label",
      "default": "center-center",
      "options": [
        {
          "label": "t:general.settings.position.options__1.label",
          "value": "top-left"
        },
        {
          "label": "t:general.settings.position.options__2.label",
          "value": "top-center"
        },
        {
          "label": "t:general.settings.position.options__3.label",
          "value": "top-right"
        },
        {
          "label": "t:general.settings.position.options__4.label",
          "value": "center-left"
        },
        {
          "label": "t:general.settings.position.options__5.label",
          "value": "center-center"
        },
        {
          "label": "t:general.settings.position.options__6.label",
          "value": "center-right"
        },
        {
          "label": "t:general.settings.position.options__7.label",
          "value": "bottom-left"
        },
        {
          "label": "t:general.settings.position.options__8.label",
          "value": "bottom-center"
        },
        {
          "label": "t:general.settings.position.options__9.label",
          "value": "bottom-right"
        }
      ]
    },
    {
      "type": "select",
      "id": "image_alignment_mobile",
      "label": "t:sections.image_banner.settings.image_alignment_mobile.label",
      "default": "center-center",
      "options": [
        {
          "label": "t:general.settings.position.options__1.label",
          "value": "top-left"
        },
        {
          "label": "t:general.settings.position.options__2.label",
          "value": "top-center"
        },
        {
          "label": "t:general.settings.position.options__3.label",
          "value": "top-right"
        },
        {
          "label": "t:general.settings.position.options__4.label",
          "value": "center-left"
        },
        {
          "label": "t:general.settings.position.options__5.label",
          "value": "center-center"
        },
        {
          "label": "t:general.settings.position.options__6.label",
          "value": "center-right"
        },
        {
          "label": "t:general.settings.position.options__7.label",
          "value": "bottom-left"
        },
        {
          "label": "t:general.settings.position.options__8.label",
          "value": "bottom-center"
        },
        {
          "label": "t:general.settings.position.options__9.label",
          "value": "bottom-right"
        }
      ]
    },
    {
      "type": "url",
      "id": "image_link",
      "label": "t:sections.image_banner.settings.image_link.label",
      "info": "t:sections.image_banner.settings.image_link.info"
    },
    {
      "type": "header",
      "content": "t:sections.image_banner.settings.header__2.content"
    },
    {
      "type": "select",
      "id": "text_position",
      "label": "t:sections.image_banner.settings.text_position.label",
      "default": "align-items-md-center",
      "options": [
        {
          "value": "align-items-md-start",
          "label": "t:sections.image_banner.settings.text_position.options__1.label"
        },
        {
          "value": "align-items-md-center",
          "label": "t:sections.image_banner.settings.text_position.options__2.label"
        },
        {
          "value": "align-items-md-end",
          "label": "t:sections.image_banner.settings.text_position.options__3.label"
        }
      ]
    },
    {
      "type": "select",
      "id": "text_position_mobile",
      "label": "t:sections.image_banner.settings.text_position_mobile.label",
      "default": "align-items-center",
      "options": [
        {
          "value": "align-items-start",
          "label": "t:sections.image_banner.settings.text_position_mobile.options__1.label"
        },
        {
          "value": "align-items-center",
          "label": "t:sections.image_banner.settings.text_position_mobile.options__2.label"
        },
        {
          "value": "align-items-end",
          "label": "t:sections.image_banner.settings.text_position_mobile.options__3.label"
        }
      ]
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "t:general.settings.text_alignment_desktop.label",
      "default": "sm:text-center justify-content-md-center",
      "options": [
        {
          "value": "sm:text-start justify-content-md-start",
          "label": "t:general.settings.text_alignment.options__1.label"
        },
        {
          "value": "sm:text-center justify-content-md-center",
          "label": "t:general.settings.text_alignment.options__2.label"
        },
        {
          "value": "sm:text-end justify-content-md-end",
          "label": "t:general.settings.text_alignment.options__3.label"
        },
        {
          "value": "sm:text-justify justify-content-md-start",
          "label": "t:general.settings.text_alignment.options__4.label"
        }
      ]
    },
    {
      "type": "select",
      "id": "text_alignment_mobile",
      "label": "t:general.settings.text_alignment_mobile.label",
      "default": "text-center justify-content-center",
      "options": [
        {
          "value": "text-start justify-content-start",
          "label": "t:general.settings.text_alignment.options__1.label"
        },
        {
          "value": "text-center justify-content-center",
          "label": "t:general.settings.text_alignment.options__2.label"
        },
        {
          "value": "text-end justify-content-end",
          "label": "t:general.settings.text_alignment.options__3.label"
        },
        {
          "value": "text-justify justify-content-start",
          "label": "t:general.settings.text_alignment.options__4.label"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:general.settings.images_loading.header.content"
    },
    {
      "type": "select",
      "id": "images_loading_type",
      "label": "t:general.settings.images_loading.images_loading_type.label",
      "default": "lazy",
      "options": [
        {
          "value": "lazy",
          "label": "t:general.settings.images_loading.images_loading_type.options__1.label"
        },
        {
          "value": "eager",
          "label": "t:general.settings.images_loading.images_loading_type.options__2.label"
        }
      ]
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "background-1"
    }
  ],
  "blocks": [
    {
      "type": "heading",
      "name": "t:sections.image_banner.blocks.heading.name",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "t:general.settings.heading.label",
          "default": "Image banner"
        }
      ]
    },
    {
      "type": "text",
      "name": "t:sections.image_banner.blocks.text.name",
      "limit": 1,
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "label": "t:general.settings.text.label",
          "default": "<p>Use overlay text to give your customers insight into your brand. Select imagery and text that relates to your story.</p>"
        },
        {
          "type": "select",
          "id": "text_size",
          "label": "t:sections.image_banner.blocks.text.settings.text_size.label",
          "default": "large",
          "options": [
            {
              "value": "medium",
              "label": "t:sections.image_banner.blocks.text.settings.text_size.options__1.label"
            },
            {
              "value": "large",
              "label": "t:sections.image_banner.blocks.text.settings.text_size.options__2.label"
            }
          ]
        }
      ]
    },
    {
      "type": "buttons",
      "name": "t:sections.image_banner.blocks.buttons.name",
      "limit": 1,
      "settings": [
        {
          "type": "header",
          "content": "t:sections.image_banner.blocks.buttons.settings.header__1.content"
        },
        {
          "type": "text",
          "id": "button_label_1",
          "label": "t:general.settings.button_label.label",
          "default": "Shop now"
        },
        {
          "type": "url",
          "id": "button_link_1",
          "label": "t:general.settings.button_link.label",
          "default": "/collections/all"
        },
        {
          "type": "select",
          "id": "button_style_1",
          "label": "t:general.settings.button_style.label",
          "default": "btn--primary",
          "options": [
            {
              "value": "",
              "label": "t:general.settings.button_style.options__1.label"
            },
            {
              "value": "btn--primary",
              "label": "t:general.settings.button_style.options__2.label"
            },
            {
              "value": "btn--outline-primary",
              "label": "t:general.settings.button_style.options__3.label"
            }
          ]
        },
        {
          "type": "header",
          "content": "t:sections.image_banner.blocks.buttons.settings.header__2.content"
        },
        {
          "type": "text",
          "id": "button_label_2",
          "label": "t:general.settings.button_label.label",
          "default": "Learn more"
        },
        {
          "type": "url",
          "id": "button_link_2",
          "label": "t:general.settings.button_link.label",
          "default": "/collections/all"
        },
        {
          "type": "select",
          "id": "button_style_2",
          "label": "t:general.settings.button_style.label",
          "default": "",
          "options": [
            {
              "value": "",
              "label": "t:general.settings.button_style.options__1.label"
            },
            {
              "value": "btn--primary",
              "label": "t:general.settings.button_style.options__2.label"
            },
            {
              "value": "btn--outline-primary",
              "label": "t:general.settings.button_style.options__3.label"
            }
          ]
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.image_banner.presets.name",
      "category": "t:sections.image_banner.presets.category",
      "blocks": [
        {
          "type": "heading"
        },
        {
          "type": "text"
        },
        {
          "type": "buttons"
        }
      ]
    }
  ]
}
{% endschema %}